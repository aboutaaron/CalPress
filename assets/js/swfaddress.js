/** * SWFAddress 2.1: Deep linking for Flash and Ajax - http://www.asual.com/swfaddress/ * * SWFAddress is (c) 2006-2007 Rostislav Hristov and is released under the MIT License: * http://www.opensource.org/licenses/mit-license.php * */if(typeof com=="undefined"){var com={};}if(typeof com.asual=="undefined"){com.asual={};}if(typeof com.asual.util=="undefined"){com.asual.util={};}com.asual.util.Browser=new function(){var _1=-1;var _2=navigator.userAgent;var _3=false;var _4=false;var _5=false;var _6=false;var _7=false;var _8=false;var _9=false;if(/MSIE/.test(_2)){_3=true;_1=parseFloat(_2.substring(_2.indexOf("MSIE")+4));}else{if(/AppleWebKit/.test(_2)){_5=true;_1=parseFloat(_2.substring(_2.indexOf("Safari")+7));}else{if(/Opera/.test(_2)){_6=true;_1=parseFloat(navigator.appVersion);}else{if(/Camino/.test(_2)){_4=true;_1=parseFloat(_2.substring(_2.indexOf("Camino")+7));}else{if(/Firefox/.test(_2)){_7=true;_1=parseFloat(_2.substring(_2.indexOf("Firefox")+8));}else{if(/Netscape/.test(_2)){_8=true;_1=parseFloat(_2.substring(_2.indexOf("Netscape")+9));}else{if(/Mozilla/.test(_2)&&/rv:/.test(_2)){_9=true;_1=parseFloat(_2.substring(_2.indexOf("rv:")+3));}}}}}}}this.getVersion=function(){return _1;};this.isIE=function(){return _3;};this.isSafari=function(){return _5;};this.isOpera=function(){return _6;};this.isCamino=function(){return _4;};this.isFirefox=function(){return _7;};this.isNetscape=function(){return _8;};this.isMozilla=function(){return _9;};};com.asual.util.Events=new function(){var _a=[];var _b=com.asual.util.Browser;var _c="DOMContentLoaded";if(_b.isIE()||_b.isSafari()){(function(){try{if(_b.isIE()||!/loaded|complete/.test(document.readyState)){document.documentElement.doScroll("left");}}catch(e){return setTimeout(arguments.callee,0);}for(var i=0,e;e=_a[i];i++){if(e.t==_c){e.l.call(null);}}})();}this.addListener=function(_f,_10,_11){_a.push({o:_f,t:_10,l:_11});if(_10==_c&&(_b.isIE()||_b.isSafari())){return;}if(_f.addEventListener){_f.addEventListener(_10,_11,false);}else{if(_f.attachEvent){_f.attachEvent("on"+_10,_11);}}};this.removeListener=function(obj,_13,_14){for(var i=0,e;e=_a[i];i++){if(e.o==obj&&e.t==_13&&e.l==_14){_a.splice(i,1);break;}}if(_13==_c&&(_b.isIE()||_b.isSafari())){return;}if(obj.removeEventListener){obj.removeEventListener(_13,_14,false);}else{if(obj.detachEvent){obj.detachEvent("on"+_13,_14);}}};var _17=function(){for(var i=0,evt;evt=_a[i];i++){if(evt.t!=_c){com.asual.util.Events.removeListener(evt.o,evt.t,evt.l);}}};this.addListener(window,"unload",_17);};SWFAddressEvent=function(_1a){this.toString=function(){return "[object SWFAddressEvent]";};this.type=_1a;this.target=[SWFAddress][0];this.value=SWFAddress.getValue();this.path=SWFAddress.getPath();this.pathNames=SWFAddress.getPathNames();this.parameters={};var _1b=SWFAddress.getParameterNames();for(var i=0,n;n=_1b[i];i++){this.parameters[n]=SWFAddress.getParameter(n);}this.parameterNames=SWFAddress.getParameterNames();};SWFAddressEvent.INIT="init";SWFAddressEvent.CHANGE="change";SWFAddress=new function(){var _1e=com.asual.util.Browser;var _1f=_1e.getVersion();var _20=false;if(_1e.isIE()){_20=_1f>=6;}else{if(_1e.isSafari()){_20=_1f>=312;}else{if(_1e.isOpera()){_20=_1f>=9.02;}else{if(_1e.isCamino()){_20=_1f>=1;}else{if(_1e.isFirefox()){_20=_1f>=1;}else{if(_1e.isNetscape()){_20=_1f>=8;}else{if(_1e.isMozilla()){_20=_1f>=1.8;}}}}}}}var _d=top.document;var _h=top.history;var _l=top.location;var _u="undefined";var _f="function";var _26,_27,_28;var _29=_d.title;var _2a=_h.length;var _2b=false;var _2c={};var _2d=[];var _2e=[];var _2f={};_2f["history"]=true;_2f["html"]=false;_2f["strict"]=true;_2f["tracker"]="_trackDefault";if((!_20&&_l.href.indexOf("#")!=-1)||(_1e.isSafari()&&_1e.getVersion()<412&&_l.href.indexOf("#")!=-1&&_l.search!="")){_d.open();_d.write("<html><head><meta http-equiv=\"refresh\" content=\"0;url="+_l.href.substr(0,_l.href.indexOf("#"))+"\" /></head></html>");_d.close();}var _30=function(){var _31=_l.href.indexOf("#");if(_31!=-1){var _32=unescape(_l.href.substr(_31+1));if(/^[a-z0-9,=_&\-\.\?\+\/]*$/.test(_32)){return _32;}else{_l.replace(_l.href.substr(0,_31));}}return "";};var _33=_30();var _34=function(_35,_36){if(_2f["strict"]){if(_36){if(_35.substr(0,1)!="/"){_35="/"+_35;}}else{if(_35==""){_35="/";}}}return _35;};var _37=function(_38){return (_1e.isIE()&&_l.protocol=="file:")?_33.replace(/\?/,"%3F"):_38;};var _39=function(el){if(el.src&&/swfaddress\.js(\?.*)?$/.test(el.src)){return el;}for(var i=0,c;c=el.childNodes[i];i++){var s=_39(c);if(s){return s;}}};var _3e=function(){if(_1e.isIE()&&_d.title!=_29){SWFAddress.setTitle(_29);}};var _3f=function(){if(!_2b){if(_1e.isIE()){if(_33!=_30()){if(_1e.getVersion()<7){_l.reload();}else{SWFAddress.setValue(_30());}}}else{if(_1e.isSafari()&&_1e.getVersion()<523){if(_2a!=_h.length){_2a=_h.length;if(typeof _2d[_2a-1]!=_u){_33=_2d[_2a-1];}_40();}}else{if(_33!=_30()){_33=_30();_40();}}}_3e();}};var _41=function(_42){if(SWFAddress.hasEventListener(_42)){SWFAddress.dispatchEvent(new SWFAddressEvent(_42));}_42=_42.substr(0,1).toUpperCase()+_42.substring(1);if(typeof SWFAddress["on"+_42]==_f){SWFAddress["on"+_42]();}};var _43=function(){_41("init");};var _44=function(){_41("change");};var _45=function(){for(var i=0,id;id=_2e[i];i++){var obj=document.getElementById(id);if(obj){if(obj.parentNode&&typeof obj.parentNode.so!=_u){obj.parentNode.so.call("setSWFAddressValue",SWFAddress.getValue());}else{obj=(obj&&typeof obj.setSWFAddressValue!=_u)?obj:((obj.getElementsByTagName("object")[0]&&typeof obj.getElementsByTagName("object")[0].setSWFAddressValue!=_u)?obj.getElementsByTagName("object")[0]:((obj.getElementsByTagName("embed")[0]&&typeof obj.getElementsByTagName("embed")[0].setSWFAddressValue!=_u)?obj.getElementsByTagName("embed")[0]:null));if(obj){obj.setSWFAddressValue(SWFAddress.getValue());}}}else{if(obj=document[id]){if(typeof obj.setSWFAddressValue!=_u){obj.setSWFAddressValue(SWFAddress.getValue());}}}}};var _40=function(){_45();_44();setTimeout(_49,10);};var _4a=function(_4b){if(typeof urchinTracker==_f){urchinTracker(_4b);}if(typeof pageTracker!=_u&&typeof pageTracker._trackPageview==_f){pageTracker._trackPageview(_4b);}};eval("var _trackDefault = "+_4a+";");var _49=function(){if(typeof _2f["tracker"]!=_u&&eval("typeof "+_2f["tracker"]+" != \"undefined\"")){var fn=eval(_2f["tracker"]);if(typeof fn==_f){fn((_l.pathname+SWFAddress.getValue()).replace(/\/\//,"/").replace(/^\/$/,""));}}};var _4d=function(){var doc=_26.contentWindow.document;doc.open();doc.write("<script>var swfaddress = \""+_30()+"\";</script>");doc.close();};var _4f=function(){if(_2f["html"]){var src=_26.contentWindow.location.href;_33=(src.indexOf("?")>-1)?src.substring(src.indexOf("?")+1):"";}else{_33=(typeof _26.contentWindow.swfaddress!=_u)?_26.contentWindow.swfaddress:"";}_26.contentWindow.document.title=_d.title;if(_33!=_30()){_40();_l.hash=_37(_33);}};var _51=function(){var _52="id=\"swfaddress\" style=\"position:absolute;top:-9999px;\"";if(_1e.isIE()){document.body.appendChild(document.createElement("div")).innerHTML="<iframe "+_52+" src=\""+(_2f["html"]?_28.replace(/\.js(\?.*)?$/,".html")+"?"+_30():"javascript:false;")+"\" width=\"0\" height=\"0\"></iframe>";_26=document.getElementById("swfaddress");setTimeout(function(){if(!_2f["html"]&&typeof _26.contentWindow.swfaddress==_u){_4d();}com.asual.util.Events.addListener(_26,"load",_4f);},10);}else{if(_1e.isSafari()){if(_1e.getVersion()<412){document.body.innerHTML+="<form "+_52+" method=\"get\"></form>";_27=document.getElementById("swfaddress");}if(typeof _l.swfaddress==_u){_l.swfaddress={};}if(typeof _l.swfaddress[_l.pathname]!=_u){_2d=_l.swfaddress[_l.pathname].split(",");}}else{if(_1e.isOpera()&&_2e.length==0&&typeof navigator.plugins["Shockwave Flash"]=="object"){document.body.innerHTML+="<embed "+_52+" src=\""+_28.replace(/\.js(\?.*)?$/,".swf")+"\" type=\"application/x-shockwave-flash\" />";}}}setTimeout(_43,1);setTimeout(_44,2);setTimeout(_49,10);setInterval(_3f,50);};this.onInit=null;this.onChange=null;this.toString=function(){return "[class SWFAddress]";};this.back=function(){_h.back();};this.forward=function(){_h.forward();};this.go=function(_53){_h.go(_53);};this.href=function(url,_55){_55=typeof _55!=_u?_55:"_self";switch(_55){case "_self":self.location.href=url;break;case "_top":_l.href=url;break;case "_blank":window.open(url);break;default:top.frames[_55].location.href=url;break;}};this.popup=function(url,_57,_58,_59){var _5a=window.open(url,_57,eval(_58));eval(_59);};this.addEventListener=function(_5b,_5c){if(typeof _2c[_5b]==_u){_2c[_5b]=[];}_2c[_5b].push(_5c);};this.removeEventListener=function(_5d,_5e){if(typeof _2c[_5d]!=_u){for(var i=0,l;l=_2c[_5d][i];i++){if(l==_5e){break;}}_2c[_5d].splice(i,1);}};this.dispatchEvent=function(_61){if(typeof _2c[_61.type]!=_u&&_2c[_61.type].length){_61.target=this;for(var i=0,l;l=_2c[_61.type][i];i++){l(_61);}return true;}return false;};this.hasEventListener=function(_64){return (typeof _2c[_64]!=_u&&_2c[_64].length>0);};this.getBaseURL=function(){var url=_l.href;if(url.indexOf("#")!=-1){url=url.substr(0,url.indexOf("#"));}if(url.substr(url.length-1)=="/"){url=url.substr(0,url.length-1);}return url;};this.getStrict=function(){return _2f["strict"];};this.setStrict=function(_66){_2f["strict"]=_66;};this.getHistory=function(){return _2f["history"];};this.setHistory=function(_67){_2f["history"]=_67;};this.getTracker=function(){return _2f["tracker"];};this.setTracker=function(_68){_2f["tracker"]=_68;};this.getIds=function(){return _2e;};this.getId=function(_69){return _2e[0];};this.setId=function(id){_2e[0]=id;};this.addId=function(id){this.removeId(id);_2e.push(id);};this.removeId=function(id){for(var i=0,_6e;_6e=_2e[i];i++){if(id==_6e){_2e.splice(i,1);break;}}};this.getTitle=function(){return _d.title;};this.setTitle=function(_6f){if(!_20){return null;}if(typeof _6f==_u){return;}if(_6f=="null"){_6f="";}_29=_d.title=_6f;if(_26&&_26.contentWindow){_26.contentWindow.document.title=_6f;}};this.getStatus=function(){return top.status;};this.setStatus=function(_70){if(!_20){return null;}if(typeof _70==_u){return;}if(!_1e.isSafari()){if(_70=="null"){_70="";}_70=_34(_70,true);if(_70=="/"){_70="";}if(!(/http(s)?:\/\//.test(_70))){var _71=_l.href.indexOf("#");_70=(_71==-1?_l.href:_l.href.substr(0,_71))+"#"+_70;}top.status=_70;}};this.resetStatus=function(){top.status="";};this.getValue=function(){if(!_20){return null;}return _34(_33,false);};this.setValue=function(_72){if(!_20){return null;}if(typeof _72==_u){return;}if(_72=="null"){_72="";}_72=_34(_72,true);if(_72=="/"){_72="";}if(_33==_72){return;}_33=_72;_2b=true;_40();_2d[_h.length]=_33;if(_1e.isSafari()){if(_2f["history"]){_l.swfaddress[_l.pathname]=_2d.toString();_2a=_h.length+1;if(_1e.getVersion()<412){if(_l.search==""){_27.action="#"+_33;_27.submit();}}else{if(_1e.getVersion()<523){var evt=document.createEvent("MouseEvents");evt.initEvent("click",true,true);var _74=document.createElement("a");_74.href="#"+_33;_74.dispatchEvent(evt);}else{_l.hash="#"+_33;}}}else{_l.replace("#"+_33);}}else{if(_33!=_30()){if(_2f["history"]){_l.hash="#"+_37(_33);}else{_l.replace("#"+_33);}}}if(_1e.isIE()&&_2f["history"]){if(_2f["html"]){_26.contentWindow.location.assign(_26.contentWindow.location.pathname+"?"+_30());}else{_4d();}}_2b=false;};this.getPath=function(){var _75=this.getValue();if(_75.indexOf("?")!=-1){return _75.split("?")[0];}else{return _75;}};this.getPathNames=function(){var _76=SWFAddress.getPath();var _77=_76.split("/");if(_76.substr(0,1)=="/"){_77.splice(0,1);}if(_76.substr(_76.length-1,1)=="/"){_77.splice(_77.length-1,1);}return _77;};this.getQueryString=function(){var _78=this.getValue();var _79=_78.indexOf("?");if(_79!=-1&&_79<_78.length){return _78.substr(_79+1);}return "";};this.getParameter=function(_7a){var _7b=this.getValue();var _7c=_7b.indexOf("?");if(_7c!=-1){_7b=_7b.substr(_7c+1);var _7d=_7b.split("&");var p,i=_7d.length;while(i--){p=_7d[i].split("=");if(p[0]==_7a){return p[1];}}}return "";};this.getParameterNames=function(){var _80=this.getValue();var _81=_80.indexOf("?");var _82=[];if(_81!=-1){_80=_80.substr(_81+1);if(_80!=""&&_80.indexOf("=")!=-1){var _83=_80.split("&");var i=0;while(i<_83.length){_82.push(_83[i].split("=")[0]);i++;}}}return _82;};if(!_20){_49();return;}for(var i=1;i<_2a;i++){_2d.push("");}_2d.push(_l.hash.replace(/^#/g,""));if(_1e.isIE()&&_l.hash!=_30()){_l.hash="#"+_37(_30());}try{_28=String(_39(document).src);var qi=_28.indexOf("?");if(_28&&qi>-1){var _87,_88=_28.substr(qi+1).split("&");for(var j=0,p;p=_88[j];j++){_87=p.split("=");if(/^(history|html|strict)$/.test(_87[0])){_2f[_87[0]]=(isNaN(_87[1])?eval(_87[1]):(parseFloat(_87[1])>0));}if(/^tracker$/.test(_87[0])){_2f[_87[0]]=_87[1];}}}}catch(e){}if(/file:\/\//.test(_l.href)){_2f["html"]=false;}_3e();com.asual.util.Events.addListener(document,"DOMContentLoaded",_51);};if(typeof swfobject!="undefined"){SWFObject=swfobject;}if(typeof FlashObject!="undefined"){SWFObject=FlashObject;}if(typeof SWFObject!="undefined"){if(SWFObject.prototype&&SWFObject.prototype.write){com.asual.SWFObjectWrite=SWFObject.prototype.write;SWFObject.prototype.write=function(){if(this.getAttribute("version").major<8){this.addVariable("$swfaddress",SWFAddress.getValue());((typeof arguments[0]=="string")?document.getElementById(arguments[0]):arguments[0]).so=this;}if(success=com.asual.SWFObjectWrite.apply(this,arguments)){SWFAddress.addId(this.getAttribute("id"));}return success;};}else{com.asual.SWFObjectRegisterObject=SWFObject.registerObject;SWFObject.registerObject=function(){com.asual.SWFObjectRegisterObject.apply(this,arguments);SWFAddress.addId(arguments[0]);};com.asual.SWFObjectCreateSWF=SWFObject.createSWF;SWFObject.createSWF=function(){com.asual.SWFObjectCreateSWF.apply(this,arguments);SWFAddress.addId(arguments[0].id);};com.asual.SWFObjectEmbedSWF=SWFObject.embedSWF;SWFObject.embedSWF=function(){com.asual.SWFObjectEmbedSWF.apply(this,arguments);SWFAddress.addId(arguments[8].id);};}}if(typeof UFO!="undefined"){com.asual.UFOCreate=UFO.create;UFO.create=function(){com.asual.UFOCreate.apply(this,arguments);SWFAddress.addId(arguments[0].id);};}if(typeof AC_FL_RunContent!="undefined"){com.asual.AC_FL_RunContent=AC_FL_RunContent;AC_FL_RunContent=function(){com.asual.AC_FL_RunContent.apply(this,arguments);for(var i=0,a;a=arguments[i];i++){if(a=="id"){SWFAddress.addId(arguments[i+1]);break;}}};}